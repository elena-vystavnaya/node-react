(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{412:function(e,t,a){},413:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a(0),c=a.n(r),s=a(20),i=a.n(s),l=a(32),o=a(52),u=a(33),j=a(55),b=a.n(j),d=a(416),h=a(37),O=a.n(h),m=a(46),p=a(49),f=a(421),x=a(425),v=a(424),g=a(94),w=a(426),k=a(427),y=a(428),S=a(429),I=a(430),E=function(e){var t=Object(u.f)(),a=e.title,c=e.theme,s=e.onChangeTheme,i=Object(r.useState)(null),j=Object(l.a)(i,2),d=j[0],h=j[1],E=localStorage.getItem("token");Object(r.useEffect)((function(){function e(){return(e=Object(p.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=5;break}return e.next=3,b.a.get("http://localhost:8000/api/user");case 3:(t=e.sent).data&&h(Object(m.a)({},t.data));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[E]);var C=Object(n.jsxs)(f.a,{children:[Object(n.jsx)(f.a.Item,{children:Object(n.jsxs)(o.b,{to:"/profile",children:[Object(n.jsx)(w.a,{}),"Profile"]})},"/profile"),Object(n.jsx)(f.a.Item,{children:Object(n.jsxs)(o.b,{to:"/edit-profile",children:[Object(n.jsx)(k.a,{}),"Edit Profile"]})},"/edit-profile"),Object(n.jsx)(f.a.Item,{children:Object(n.jsxs)(o.b,{to:"/files",children:[Object(n.jsx)(y.a,{}),"Files"]})},"/files"),Object(n.jsx)(f.a.Divider,{}),Object(n.jsxs)(f.a.Item,{danger:!0,onClick:function(){localStorage.removeItem("token"),h(null),t.push("/login")},children:[Object(n.jsx)(S.a,{}),"Logout"]},"3")]});return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h1",{children:a}),Object(n.jsxs)("div",{children:[Object(n.jsx)(x.a,{checked:c,onChange:s}),d?Object(n.jsx)(v.a,{overlay:C,trigger:["click"],children:Object(n.jsxs)(g.a,{onClick:function(e){return e.preventDefault()},children:[d.username,Object(n.jsx)(I.a,{})]})}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(o.b,{to:"/login",children:"Sign in"})," |",Object(n.jsx)(o.b,{to:"/register",children:"Sign up"})]})]})]})},C=function(e){var t=e.routes,a=Object(u.f)();return Object(n.jsx)(f.a,{theme:e.theme?"light":"dark",defaultSelectedKeys:[a.location.pathname],mode:"inline",children:t&&t.map((function(e){return Object(n.jsx)(f.a.Item,{children:Object(n.jsx)(o.c,{to:e.path,children:e.title})},e.path)}))})},T=a(95),$=a(58),N=a(422),P=function(e){var t=e.users;return Object(n.jsx)(T.a,{gutter:16,className:"items",children:t?t.map((function(e,t){return Object(n.jsxs)($.a,{span:6,className:"item",children:[Object(n.jsxs)("div",{className:"username",children:[e.username,Object(n.jsx)(N.a,{status:e.isOnline?"success":"error"})]}),Object(n.jsx)("div",{className:"user-email",children:e.email})]},t)})):"Users not found"})},q=function(){return Object(n.jsx)("div",{children:"home"})},D=a(415),F=a(417),A=a(420),R=a(419),U=a(418),z=a(220),L=a(423);var B=function(e){var t=Object(r.useState)(e.label),a=Object(l.a)(t,1)[0],c=Object(r.useState)(e.type),s=Object(l.a)(c,1)[0],i=Object(r.useState)(e.value),o=Object(l.a)(i,2),u=o[0],j=o[1];return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(U.a.Item,{label:a,name:s,initialValue:u,value:u,onChange:function(e){j(e.target.value)},children:Object(n.jsx)(L.a,{name:s})})})},H=function(){var e=function(e){var t=Object(r.useState)(null),a=Object(l.a)(t,2),n=a[0],c=a[1],s=Object(r.useState)(!1),i=Object(l.a)(s,2),o=i[0],u=i[1],j=Object(r.useCallback)((function(){!function(){var t=Object(p.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u(!0),a="http://localhost:8000/api/".concat(e),t.next=4,b.a.get(a);case 4:n=t.sent;try{n.data.error?z.b.error(n.data.error):n.data&&c(n.data)}catch(r){z.b.error("Something went wrong"),console.log(r)}u(!1);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e]);return Object(r.useEffect)((function(){j()}),[j]),{data:n,loading:o,refetch:j}}("user"),t=e.data,a=e.loading,c=Object(r.useState)({username:"default"}),s=Object(l.a)(c,2),i=s[0],o=s[1],u=Object(r.useState)({current:"",new:""}),j=Object(l.a)(u,2),d=j[0];j[1];return Object(r.useEffect)((function(){o(t)}),[t]),a?Object(n.jsx)(D.a,{}):t?Object(n.jsxs)(T.a,{gutter:16,children:[Object(n.jsx)($.a,{span:8,children:Object(n.jsxs)(F.a,{className:"card-user",children:[Object(n.jsx)(A.a,{size:100,icon:Object(n.jsx)(w.a,{})}),Object(n.jsx)(R.a.Title,{level:2,children:t.username})]})}),Object(n.jsx)($.a,{span:16,children:Object(n.jsx)(F.a,{title:"Account Details",children:Object(n.jsx)(U.a,{layout:"vertical",children:Object(n.jsxs)(T.a,{gutter:16,children:[Object(n.jsx)($.a,{span:12,children:Object(n.jsx)(B,{label:"Name",type:"text",value:i.username})}),Object(n.jsx)($.a,{span:12,children:Object(n.jsx)(B,{label:"Email",type:"email",value:i.email})}),Object(n.jsx)($.a,{span:12,children:Object(n.jsx)(B,{label:"Password",type:"password",value:d.current})}),Object(n.jsx)($.a,{span:12,children:Object(n.jsx)(B,{label:"New Password",type:"password",value:d.old})})]})})})})]}):null},J=a(85),M=function(e){return function(){var t=Object(p.a)(O.a.mark((function t(a){var n,r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.variables,r="http://localhost:8000/api/".concat(e),t.next=4,b.a.post(r,n);case 4:if(c=t.sent,t.prev=5,!c.data.error){t.next=10;break}z.b.error(c.data.error),t.next=12;break;case 10:if(!c.data){t.next=12;break}return t.abrupt("return",c.data);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(5),z.b.error("Something went wrong"),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(e){return t.apply(this,arguments)}}()},V={required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!",regexp:"${label} must including uppercase, lowercase letters and numbers"},number:{range:"${label} must be between ${min} and ${max}"},string:{min:"${label} must be at least ${min} characters",max:"${label} cannot be longer than ${max} characters"},pattern:{mismatch:"${label} must including letters and numbers."}},_=function(){var e=Object(u.f)(),t=Object(r.useState)({username:null,email:null,password:null}),a=Object(l.a)(t,2),c=a[0],s=a[1],i=M("register"),o=function(){var t=Object(p.a)(O.a.mark((function t(){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({variables:Object(m.a)({},c)});case 2:(a=t.sent)&&(z.b.success("User was created"),localStorage.setItem("token",a.token),e.push("/"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e){s(Object(m.a)(Object(m.a)({},c),{},Object(J.a)({},e.target.name,e.target.value)))};return Object(n.jsxs)(U.a,{onFinish:o,layout:"vertical",validateMessages:V,children:[Object(n.jsx)(U.a.Item,{label:"Username",name:"username",value:c.username,onChange:j,rules:[{required:!0}],children:Object(n.jsx)(L.a,{name:"username"})}),Object(n.jsx)(U.a.Item,{label:"Email",name:"email",value:c.email,onChange:j,rules:[{required:!0,type:"email"}],children:Object(n.jsx)(L.a,{name:"email"})}),Object(n.jsx)(U.a.Item,{label:"Password",name:"password",value:c.password,onChange:j,rules:[{required:!0,min:8},{pattern:/(?=.*\d)(?=.*[a-z])/}],children:Object(n.jsx)(L.a.Password,{name:"password"})}),Object(n.jsx)(U.a.Item,{children:Object(n.jsx)(g.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})},K=function(){var e=Object(u.f)(),t=Object(r.useState)({email:null,password:null}),a=Object(l.a)(t,2),c=a[0],s=a[1],i=M("login"),o=function(){var t=Object(p.a)(O.a.mark((function t(){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({variables:Object(m.a)({},c)});case 2:(a=t.sent)&&(localStorage.setItem("token",a.token),e.push("/"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e){s(Object(m.a)(Object(m.a)({},c),{},Object(J.a)({},e.target.name,e.target.value)))};return Object(n.jsxs)(U.a,{onFinish:o,layout:"vertical",validateMessages:V,children:[Object(n.jsx)(U.a.Item,{label:"Email",name:"email",value:c.email,onChange:j,rules:[{required:!0,type:"email"}],children:Object(n.jsx)(L.a,{name:"email"})}),Object(n.jsx)(U.a.Item,{label:"Password",name:"password",value:c.password,onChange:j,rules:[{required:!0,message:"Please input your password!"}],children:Object(n.jsx)(L.a.Password,{name:"password"})}),Object(n.jsx)(U.a.Item,{children:Object(n.jsx)(g.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})},W=function(e){var t=e.title,a=e.setTitle;return Object(r.useEffect)((function(){a(t),document.title=t}),[t,a]),e.children},G=a(216),Q=a(74),X=a(212),Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CURRENT_USER":var a=t.payload,n=a.id,r=a.username,c=a.email,s=a.password;return{id:n,username:r,email:c,password:s};default:return e}},Z=Object(Q.combineReducers)({user:Y}),ee=a(213),te=a(214),ae=a(221),ne=a(217),re=function(){return Object(n.jsx)("h1",{children:"Something went wrong"})},ce=function(e){Object(ae.a)(a,e);var t=Object(ne.a)(a);function a(){var e;Object(ee.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1,error:{message:"",stack:""},info:{componentStack:""}},e}return Object(te.a)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){var e=this.state.hasError,t=this.props.children;return e?Object(n.jsx)(re,{}):t}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(c.a.Component),se=a(222),ie=function(e){var t=e.component,a=Object(se.a)(e,["component"]),c=Object(u.f)();return Object(r.useEffect)((function(){function e(){return(e=Object(p.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:8000/api/verifyToken",{token:localStorage.getItem("token")});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),c.push("/login");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c]),Object(n.jsx)(u.a,Object(m.a)(Object(m.a)({},a),{},{render:function(e){return Object(n.jsxs)(ce,{children:[Object(n.jsx)(W,Object(m.a)(Object(m.a)({setTitle:a.setTitle,title:a.title},e),{},{children:t}))," "]})}}))},le=a(215),oe=a.n(le),ue=function(e){var t=Object(r.useState)([]),a=Object(l.a)(t,2),n=a[0],c=a[1],s=Object(r.useState)(null),i=Object(l.a)(s,2),o=i[0],u=i[1],j=Object(r.useRef)(null),d=localStorage.getItem("token");return Object(r.useEffect)((function(){function e(){return(e=Object(p.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=5;break}return e.next=3,b.a.get("http://localhost:8000/api/user");case 3:(t=e.sent).data&&(u(t.data),localStorage.setItem("userId",t.data.id));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d]),Object(r.useEffect)((function(){if(o){j.current=oe()("http://localhost:8000/",{transports:["websocket"],query:{roomId:e},auth:{token:d}});var t=o&&o.id;if(t&&d)return j.current.emit("user:add",t),j.current.on("users",(function(e){c(e)})),function(){j.current.disconnect(t),j.current.emit("user:leave",t)};if(!d)return j.current.emit("user:leave",t),function(){j.current.disconnect(t)}}}),[e,o,d]),function(e){var t=function(t){var a;return(a="function"===typeof e?e(t):e)&&(t.preventDefault(),t.returnValue=a),a};Object(r.useEffect)((function(){return window.addEventListener("beforeunload",t),function(){window.removeEventListener("beforeunload",t)}}),[])}((function(){j.current.emit("user:leave",localStorage.getItem("userId"))})),{users:n}},je=Object(Q.createStore)(Z,Object(X.composeWithDevTools)()),be=function(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),a=t[0],c=t[1],s=Object(r.useState)(!0),i=Object(l.a)(s,2),j=i[0],h=i[1],O=ue("room").users,m=[{component:Object(n.jsx)(q,{}),path:"/",title:"Home",exact:!0},{component:Object(n.jsx)(H,{}),path:"/profile",title:"Profile"},{component:Object(n.jsx)(P,{users:O}),path:"/about",title:"About"}],p=[{component:Object(n.jsx)(_,{}),path:"/register",title:"Sign up"},{component:Object(n.jsx)(K,{}),path:"/login",title:"Sign in"}];return b.a.interceptors.request.use((function(e){var t=localStorage.getItem("token");return e.headers.Authorization="Bearer ".concat(t),e})),Object(n.jsx)(G.a,{store:je,children:Object(n.jsx)(o.a,{children:Object(n.jsxs)(d.a,{className:j?"light":"dark",children:[Object(n.jsx)(d.a.Sider,{breakpoint:"xxl",children:Object(n.jsx)(C,{theme:j,routes:m})}),Object(n.jsxs)(d.a,{className:j?"light":"dark",children:[Object(n.jsx)(d.a.Header,{children:Object(n.jsx)(E,{title:a,theme:j,onChangeTheme:function(){h(!j)}})}),Object(n.jsx)(d.a.Content,{children:Object(n.jsxs)(u.c,{children:[p.map((function(e,t){return Object(n.jsx)(u.a,{path:e.path,title:e.title,exact:e.exact,children:Object(n.jsx)(ce,{children:Object(n.jsx)(W,{setTitle:c,title:e.title,children:e.component})})},t)})),m.map((function(e,t){return Object(n.jsx)(ie,{path:e.path,title:e.title,exact:e.exact,setTitle:c,component:e.component},t)}))]})}),Object(n.jsx)(d.a.Footer,{children:"Footer"})]})]})})})};a(411),a(412);i.a.render(Object(n.jsx)(be,{}),document.getElementById("root"))}},[[413,1,2]]]);
//# sourceMappingURL=main.5f40e058.chunk.js.map
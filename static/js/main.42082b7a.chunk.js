(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{361:function(e,t,n){},362:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n(0),c=n.n(a),s=n(19),i=n.n(s),o=n(48),l=n(43),u=n(25),j=n(56),b=n.n(j),d=n(367),m=n(28),h=n.n(m),p=n(38),O=n(47),f=n(371),x=n(374),v=n(373),g=n(80),w=n(375),k=n(376),y=n(377),S=n(378),I=n(379),E=function(e){var t=Object(u.f)(),n=e.title,c=e.theme,s=e.onChangeTheme,i=Object(a.useState)(null),j=Object(o.a)(i,2),d=j[0],m=j[1],E=localStorage.getItem("token");Object(a.useEffect)((function(){function e(){return(e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=5;break}return e.next=3,b.a.get("http://localhost:8000/api/user");case 3:(t=e.sent).data&&m(Object(p.a)({},t.data));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[E]);var C=Object(r.jsxs)(f.a,{children:[Object(r.jsx)(f.a.Item,{children:Object(r.jsxs)(l.b,{to:"/profile",children:[Object(r.jsx)(w.a,{}),"Profile"]})},"/profile"),Object(r.jsx)(f.a.Item,{children:Object(r.jsxs)(l.b,{to:"/edit-profile",children:[Object(r.jsx)(k.a,{}),"Edit Profile"]})},"/edit-profile"),Object(r.jsx)(f.a.Item,{children:Object(r.jsxs)(l.b,{to:"/files",children:[Object(r.jsx)(y.a,{}),"Files"]})},"/files"),Object(r.jsx)(f.a.Divider,{}),Object(r.jsxs)(f.a.Item,{danger:!0,onClick:function(){localStorage.removeItem("token"),m(null),t.push("/login")},children:[Object(r.jsx)(S.a,{}),"Logout"]},"3")]});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:n}),Object(r.jsxs)("div",{children:[Object(r.jsx)(x.a,{checked:c,onChange:s}),d?Object(r.jsx)(v.a,{overlay:C,trigger:["click"],children:Object(r.jsxs)(g.a,{onClick:function(e){return e.preventDefault()},children:[d.username,Object(r.jsx)(I.a,{})]})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(l.b,{to:"/login",children:"Sign in"})," |",Object(r.jsx)(l.b,{to:"/register",children:"Sign up"})]})]})]})},C=function(e){var t=e.routes,n=Object(u.f)();return Object(r.jsx)(f.a,{theme:e.theme?"light":"dark",defaultSelectedKeys:[n.location.pathname],mode:"inline",children:t&&t.map((function(e){return Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(l.c,{to:e.path,children:e.title})},e.path)}))})},T=n(365),$=n(366),q=n(372),D=function(e){var t=e.users;return Object(r.jsx)(T.a,{gutter:16,className:"items",children:t?t.map((function(e,t){return Object(r.jsxs)($.a,{span:6,className:"item",children:[Object(r.jsxs)("div",{className:"username",children:[e.username,Object(r.jsx)(q.a,{status:e.isOnline?"success":"error"})]}),Object(r.jsx)("div",{className:"user-email",children:e.email})]},t)})):"Users not found"})},F=function(){return Object(r.jsx)("div",{children:"home"})},P=function(){return Object(r.jsx)("div",{children:"profile"})},N=n(73),R=n(368),U=n(369),A=n(370),L=function(e){return function(){var t=Object(O.a)(h.a.mark((function t(n){var r,a,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.variables,a="http://localhost:8000/api/".concat(e),t.next=4,b.a.post(a,r);case 4:if(c=t.sent,t.prev=5,!c.data.error){t.next=10;break}A.b.error(c.data.error),t.next=12;break;case 10:if(!c.data){t.next=12;break}return t.abrupt("return",c.data);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(5),A.b.error("Something went wrong"),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(e){return t.apply(this,arguments)}}()},z={required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!",regexp:"${label} must including uppercase, lowercase letters and numbers"},number:{range:"${label} must be between ${min} and ${max}"},string:{min:"${label} must be at least ${min} characters",max:"${label} cannot be longer than ${max} characters"},pattern:{mismatch:"${label} must including letters and numbers."}},B=function(){var e=Object(u.f)(),t=Object(a.useState)({username:null,email:null,password:null}),n=Object(o.a)(t,2),c=n[0],s=n[1],i=L("register"),l=function(){var t=Object(O.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({variables:Object(p.a)({},c)});case 2:(n=t.sent)&&(A.b.success("User was created"),localStorage.setItem("token",n.token),e.push("/"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e){s(Object(p.a)(Object(p.a)({},c),{},Object(N.a)({},e.target.name,e.target.value)))};return Object(r.jsxs)(R.a,{onFinish:l,layout:"vertical",validateMessages:z,children:[Object(r.jsx)(R.a.Item,{label:"Username",name:"username",value:c.username,onChange:j,rules:[{required:!0}],children:Object(r.jsx)(U.a,{name:"username"})}),Object(r.jsx)(R.a.Item,{label:"Email",name:"email",value:c.email,onChange:j,rules:[{required:!0,type:"email"}],children:Object(r.jsx)(U.a,{name:"email"})}),Object(r.jsx)(R.a.Item,{label:"Password",name:"password",value:c.password,onChange:j,rules:[{required:!0,min:8},{pattern:/(?=.*\d)(?=.*[a-z])/}],children:Object(r.jsx)(U.a.Password,{name:"password"})}),Object(r.jsx)(R.a.Item,{children:Object(r.jsx)(g.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})},H=function(){var e=Object(u.f)(),t=Object(a.useState)({email:null,password:null}),n=Object(o.a)(t,2),c=n[0],s=n[1],i=L("login"),l=function(){var t=Object(O.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({variables:Object(p.a)({},c)});case 2:(n=t.sent)&&(localStorage.setItem("token",n.token),e.push("/"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e){s(Object(p.a)(Object(p.a)({},c),{},Object(N.a)({},e.target.name,e.target.value)))};return Object(r.jsxs)(R.a,{onFinish:l,layout:"vertical",validateMessages:z,children:[Object(r.jsx)(R.a.Item,{label:"Email",name:"email",value:c.email,onChange:j,rules:[{required:!0,type:"email"}],children:Object(r.jsx)(U.a,{name:"email"})}),Object(r.jsx)(R.a.Item,{label:"Password",name:"password",value:c.password,onChange:j,rules:[{required:!0,message:"Please input your password!"}],children:Object(r.jsx)(U.a.Password,{name:"password"})}),Object(r.jsx)(R.a.Item,{children:Object(r.jsx)(g.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})},J=function(e){var t=e.title,n=e.setTitle;return Object(a.useEffect)((function(){n(t),document.title=t}),[t,n]),e.children},M=n(190),_=n(65),K=n(186),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CURRENT_USER":var n=t.payload,r=n.id,a=n.username,c=n.email,s=n.password;return{id:r,username:a,email:c,password:s};default:return e}},W=Object(_.combineReducers)({user:V}),G=n(187),Q=n(188),X=n(195),Y=n(191),Z=function(){return Object(r.jsx)("h1",{children:"Something went wrong"})},ee=function(e){Object(X.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(G.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={hasError:!1,error:{message:"",stack:""},info:{componentStack:""}},e}return Object(Q.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){var e=this.state.hasError,t=this.props.children;return e?Object(r.jsx)(Z,{}):t}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(c.a.Component),te=n(196),ne=function(e){var t=e.component,n=Object(te.a)(e,["component"]),c=Object(u.f)();return Object(a.useEffect)((function(){function e(){return(e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("http://localhost:8000/api/verifyToken",{token:localStorage.getItem("token")});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),c.push("/login");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c]),Object(r.jsx)(u.a,Object(p.a)(Object(p.a)({},n),{},{render:function(e){return Object(r.jsxs)(ee,{children:[Object(r.jsx)(J,Object(p.a)(Object(p.a)({setTitle:n.setTitle,title:n.title},e),{},{children:t}))," "]})}}))},re=n(189),ae=n.n(re),ce=function(e){var t=Object(a.useState)([]),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),l=i[0],u=i[1],j=Object(a.useRef)(null),d=localStorage.getItem("token");return Object(a.useEffect)((function(){function e(){return(e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=5;break}return e.next=3,b.a.get("http://localhost:8000/api/user");case 3:(t=e.sent).data&&(u(t.data),localStorage.setItem("userId",t.data.id));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d]),Object(a.useEffect)((function(){if(l){j.current=ae()("http://localhost:8000/",{transports:["websocket"],query:{roomId:e},auth:{token:d}});var t=l&&l.id;if(t&&d)return j.current.emit("user:add",t),j.current.on("users",(function(e){c(e)})),function(){j.current.disconnect(t),j.current.emit("user:leave",t)};if(!d)return j.current.emit("user:leave",t),function(){j.current.disconnect(t)}}}),[e,l,d]),function(e){var t=function(t){var n;return(n="function"===typeof e?e(t):e)&&(t.preventDefault(),t.returnValue=n),n};Object(a.useEffect)((function(){return window.addEventListener("beforeunload",t),function(){window.removeEventListener("beforeunload",t)}}),[])}((function(){j.current.emit("user:leave",localStorage.getItem("userId"))})),{users:r}},se=Object(_.createStore)(W,Object(K.composeWithDevTools)()),ie=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(!0),i=Object(o.a)(s,2),j=i[0],m=i[1],h=ce("room").users,p=[{component:Object(r.jsx)(F,{}),path:"/",title:"Home",exact:!0},{component:Object(r.jsx)(P,{}),path:"/profile",title:"Profile"},{component:Object(r.jsx)(D,{users:h}),path:"/about",title:"About"}],O=[{component:Object(r.jsx)(B,{}),path:"/register",title:"Sign up"},{component:Object(r.jsx)(H,{}),path:"/login",title:"Sign in"}];return b.a.interceptors.request.use((function(e){var t=localStorage.getItem("token");return e.headers.Authorization="Bearer ".concat(t),e})),Object(r.jsx)(M.a,{store:se,children:Object(r.jsx)(l.a,{children:Object(r.jsxs)(d.a,{className:j?"light":"dark",children:[Object(r.jsx)(d.a.Sider,{breakpoint:"xxl",children:Object(r.jsx)(C,{theme:j,routes:p})}),Object(r.jsxs)(d.a,{className:j?"light":"dark",children:[Object(r.jsx)(d.a.Header,{children:Object(r.jsx)(E,{title:n,theme:j,onChangeTheme:function(){m(!j)}})}),Object(r.jsx)(d.a.Content,{children:Object(r.jsxs)(u.c,{children:[O.map((function(e,t){return Object(r.jsx)(u.a,{path:e.path,title:e.title,exact:e.exact,children:Object(r.jsx)(ee,{children:Object(r.jsx)(J,{setTitle:c,title:e.title,children:e.component})})},t)})),p.map((function(e,t){return Object(r.jsx)(ne,{path:e.path,title:e.title,exact:e.exact,setTitle:c,component:e.component},t)}))]})}),Object(r.jsx)(d.a.Footer,{children:"Footer"})]})]})})})};n(360),n(361);i.a.render(Object(r.jsx)(ie,{}),document.getElementById("root"))}},[[362,1,2]]]);
//# sourceMappingURL=main.42082b7a.chunk.js.map